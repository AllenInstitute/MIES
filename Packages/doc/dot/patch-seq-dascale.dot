digraph G {
	graph [center=true,
		color=white,
		compound=true,
		fontcolor=black,
		fontname=Helvetica,
		fontsize=14,
		penwidth=0.1,
		ratio="0,01"
	];
	node [color="#bdd7e7",
		fillcolor="#eff3ff",
		fontcolor="#2171b5",
		fontname=Helvetica,
		fontsize=13,
		label="\N",
		shape=ellipse,
		style=filled
	];
	edge [color="#9ecae1",
		fontcolor="#3182bd",
		fontname=Helvetica,
		fontsize=10,
		style=solid
	];
	"Start DAQ/RA" -> "Mid Sweep Event";
	"Start DAQ/RA" -> "Post DAQ Event";
	"Start DAQ/RA" -> "Post Set Event";
	"Start DAQ/RA" -> "Post Sweep Event";
	"Start DAQ/RA" -> "Pre Sweep Config Event";
	"Start DAQ/RA" -> "Prepare DAQ/Pre Set Event";
	"Mid Sweep Event" -> "BL QC passed?";
	"Post DAQ Event" -> "Update Dashboard";
	"Post Set Event" -> "Update Dashboard";
	"Post Set Event" -> "Get OperationMode [2]";
	n91	[URL="../_static/images/async-qc-channels.svg",
		label="Standard AsyncQCChannels handling",
		target=_graphviz];
	"Post Sweep Event" -> n91;
	"Last Sweep passed?"	[label="BL QC passed? [2]"];
	"Post Sweep Event" -> "Last Sweep passed?";
	n92	[URL="../_static/images/async-qc-channels.svg",
		label="Standard AsyncQCChannels handling",
		target=_graphviz];
	"Pre Sweep Config Event" -> n92;
	"Prepare DAQ/Pre Set Event" -> "Enable \"Autobias\"";
	"Prepare DAQ/Pre Set Event" -> "Valid Autobias voltage (finite and non-zero)";
	"BL QC passed?" -> "Grab next completely acquired chunk\n(500ms) of stimset baseline"	[label=No];
	"Get OperationMode [2]" -> "Mark set as passed if $NUM_DA_SCALES\nsweeps passed, as failure otherwise"	[label=Sub];
	"Get OperationMode [2]" -> "Labnotebook has fI-Slope reached entry?"	[label=Supra];
	n72	[label="Mark sweep as failed"];
	"Last Sweep passed?" -> n72	[label=No];
	n75	[label="Read \"SamplingFrequency\" analysis parameter\n (defaulting to 50kHz) if not present"];
	"Last Sweep passed?" -> n75	[label=Yes];
	"Enable \"Autobias\"" -> "Enable \"TP during ITI\"";
	"Valid Autobias voltage (finite and non-zero)" -> "Check if no TTL channels are active";
	"Grab next completely acquired chunk\n(500ms) of stimset baseline" -> "Chunk already evaluated?"	[label="Have one"];
	"Grab next completely acquired chunk\n(500ms) of stimset baseline" -> "Last chunk?"	[label="None left"];
	"Labnotebook has fI-Slope reached entry?" -> "Mark set as passed if $NUM_DA_SCALES\nsweeps passed, as failure otherwise"	[label=No];
	"Labnotebook has fI-Slope reached entry?" -> "Reached?"	[label=Yes];
	n72 -> "Check if the Set can still pass";
	n76	[label="Check if the acquired data\n has that sampling interval"];
	n75 -> n76;
	"Enable \"TP during ITI\"" -> "Enable \"Multidevice DAQ\"";
	"Check if no TTL channels are active" -> "Stimset is large enough";
	"Chunk already evaluated?" -> "Grab next completely acquired chunk\n(500ms) of stimset baseline"	[label=Yes];
	"Chunk already evaluated?" -> "Baseline chunk type"	[label=No];
	"Last chunk?" -> "Mark Sweep as failed"	[label=Yes];
	"Reached?" -> "Mark set as passed if $NUM_DA_SCALES\nsweeps passed, as failure otherwise"	[label=Yes];
	"Reached?" -> "Mark set as failed"	[label=No];
	"Check if the Set can still pass" -> "Skip to end"	[label=No];
	n76 -> n72	[label=No];
	n76 -> "Skip to end"	[label=No];
	n77	[label="Has Async Channels QC\n labnotebook entry passed?"];
	n76 -> n77	[label=Yes];
	"Enable \"Multidevice DAQ\"" -> "Disable \"dDAQ\"/\"oodDAQ\"";
	"Stimset is large enough" -> "Check if mode is IC";
	"Baseline chunk type" -> "Check RMS short"	[label="pre pulse"];
	"Baseline chunk type" -> "Check target voltage [2]"	[label="post pulse"];
	n73	[label="Mark sweep as passed"];
	n73 -> "Get OperationMode [3]";
	"Disable \"dDAQ\"/\"oodDAQ\"" -> "Enable \"Repeated Acquisition\"";
	"Check if mode is IC" -> "Check if only one headstage is active";
	"Check RMS short" -> "Check RMS long"	[label=Passed];
	"Check RMS short" -> "Add BL QC failed labnotebook entry"	[label=Failed];
	"Check target voltage [2]" -> "Mark chunk as passed/failed [2]";
	"Get OperationMode [3]" -> "Calculate TP-like properties\nand store them in the\nlabnotebook"	[label=Sub];
	"Get OperationMode [3]" -> "Search for spikes\n(x range: pulse onset to end of sweep\ny condition: max above 0.01mV)"	[label=Supra];
	"Enable \"Repeated Acquisition\"" -> "Enable \"Insert TP\"";
	"Check if only one headstage is active" -> "All checks passed";
	"Check RMS long" -> "Add BL QC failed labnotebook entry"	[label=Failed];
	"Check RMS long" -> "Check target voltage [1]"	[label=Passed];
	"Add BL QC failed labnotebook entry" -> "Early Sweep stop";
	"Mark chunk as passed/failed [2]" -> "Grab next completely acquired chunk\n(500ms) of stimset baseline"	[label=Failed];
	"Mark chunk as passed/failed [2]" -> "Add BL QC passed labnotebook entry"	[label=Passed];
	"Calculate TP-like properties\nand store them in the\nlabnotebook" -> "Check if $NUM_DA_SCALES\nsweeps passed from RA cycle";
	"Calculate TP-like properties\nand store them in the\nlabnotebook" -> "Optional parameter ShowPlot\nis true or missing";
	"Search for spikes\n(x range: pulse onset to end of sweep\ny condition: max above 0.01mV)" -> "Write number of spikes\ninto labnotebook";
	n68	[label="Use \"SamplingMultiplier\" analysis parameter\n (defaulting to 4 if not present) and set it."];
	"Enable \"Insert TP\"" -> n68;
	"All checks passed" -> Abort	[label=No];
	"All checks passed" -> "Use first DAScale value"	[label=Yes];
	"Check target voltage [1]" -> "Mark chunk as passed/failed [1]";
	"Add BL QC passed labnotebook entry" -> "Early Sweep stop";
	"Check if $NUM_DA_SCALES\nsweeps passed from RA cycle" -> "Skip to end of active set"	[label=Yes];
	"Check if $NUM_DA_SCALES\nsweeps passed from RA cycle" -> "Use next DAScale value"	[label=No];
	"Optional parameter ShowPlot\nis true or missing" -> "Plot the resistance (Sub)\nor fI (Supra)"	[label=Yes];
	"Write number of spikes\ninto labnotebook" -> "Analysis parameters MinimumSpikeCount,\n MaximumSpikeCount,\n DAScaleModifier\n present?";
	"Write number of spikes\ninto labnotebook" -> "Determine pulse duration\nand write it into the labnotebook";
	"Use first DAScale value" -> "Get OperationMode";
	"Mark chunk as passed/failed [1]" -> "Grab next completely acquired chunk\n(500ms) of stimset baseline"	[label=Passed];
	"Mark chunk as passed/failed [1]" -> "Early sweep stop, repurpose ITI and add 10s to ITI"	[label=Failed];
	"Analysis parameters MinimumSpikeCount,\n MaximumSpikeCount,\n DAScaleModifier\n present?" -> "Use next DAScale value"	[label=No];
	"Analysis parameters MinimumSpikeCount,\n MaximumSpikeCount,\n DAScaleModifier\n present?" -> "Spike count relative to\nMin and Max?"	[label=Yes];
	"Determine pulse duration\nand write it into the labnotebook" -> "Create spike frequency vs DAScale (fI) data\nand peform linear regression";
	"Get OperationMode" -> "Look for a rheobase sweep with passing set QC,\n pulse duration longer than 500ms\n and having spiked"	[label=Supra];
	"Get OperationMode" -> "Use the DAScale values\nfrom the analysis parameters"	[label=Sub];
	"Spike count relative to\nMin and Max?" -> "Use next DAScale value"	[label="In-between"];
	"Spike count relative to\nMin and Max?" -> "Adapt DAScale\n by a factor of 1 - Modifier"	[label=Above];
	"Spike count relative to\nMin and Max?" -> "Adapt DAScale\n by a factor of 1 + Modifier"	[label=Below];
	"Create spike frequency vs DAScale (fI) data\nand peform linear regression" -> "Optional parameter ShowPlot\nis true or missing";
	"Create spike frequency vs DAScale (fI) data\nand peform linear regression" -> "Write fI-Slope into labnotebook";
	"Look for a rheobase sweep with passing set QC,\n pulse duration longer than 500ms\n and having spiked" -> Abort	[label="Not found"];
	"Look for a rheobase sweep with passing set QC,\n pulse duration longer than 500ms\n and having spiked" -> "Use the DAScale value of that sweep\n as offset to the DAScale values from the analysis parameters"	[label=Found];
	"Adapt DAScale\n by a factor of 1 - Modifier" -> "Use next DAScale value";
	"Adapt DAScale\n by a factor of 1 + Modifier" -> "Use next DAScale value";
	"Write fI-Slope into labnotebook" -> "Optional FinalSlopePercent\nparameter present?";
	"Optional FinalSlopePercent\nparameter present?" -> "Add labnotebook entry if the\ndesired fI-Slope was reached or not"	[label=Yes];
	n77 -> n72	[label=No];
	n77 -> n73	[label=Yes];
}
